# T1192-Spearphishing Link-钓鱼攻击（超链接）

## 模块简介

带链接的鱼叉攻击是鱼叉化的特定变体。它与其他形式的鱼叉式攻击不同之处在于，它使用链接下载电子邮件中包含的恶意软件，而不是将恶意文件附加到电子邮件本身，以避免可能检查电子邮件附件的防御措施。

所有形式的鱼叉式攻击都是以电子方式提供的针对特定个人，公司或行业的社会工程。在这种情况下，恶意电子邮件包含链接。通常，这些链接将伴随社会工程文本，并要求用户利用管理权权限主动单击或复制URL并将其粘贴到浏览器中。访问的网站可能会利用漏洞利用Web浏览器，或者首先提示用户下载应用程序，文档，zip文件甚至可执行文件，具体取决于电子邮件的诈骗内容。攻击者还可能包含旨在直接与电子邮件阅读器进行交互的链接，包括旨在直接利用终端系统或验证电子邮件的接收（即Web错误/ Web信标）的嵌入式图像。链接还可以将用户定向到旨在窃取应用程序访问令牌（例如OAuth令牌）的恶意应用程序，以获取对受保护的应用程序和信息的访问权限。

## 检测思路

电子邮件中的URL检查（包括扩展缩短的链接）可以帮助检测导致已知恶意站点的链接。沙箱可用于检测这些链接，并自动转到这些站点以确定它们是否可能有害，或者在用户访问链接时等待并捕获内容。

由于此技术通常涉及端点上的用户交互，因此一旦用户只需，许多手段可能会检测到Spearphishing链接。

## 应急手段

1. 开启现有的防病毒网关
2. 开启现有的邮件网关
3. 安装主机安全的相关产品
4. 开启恶意流量监测系统
5. 结合恶意情报的用户行为审计

## 排查工具

### 进程类

netstat、ps

### 用户历史

histroy、find

## 工具操作说明

### 进程排查

Netstat

```
netstat -anp | grep "port"
```

ps

```
ps -aux | grep "/bin/bash"
```

### 用户历史

history

```
history | grep "wget"
cat /homr/username/.bash_history | grep -E 'wget|curl'
cat /var/log/audit/audit.log |grep 'wget|curl'
```

find

```
查找24小时内被修改的jsp文件：find / -mtime 0 -name *.jsp
```

