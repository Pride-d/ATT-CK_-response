# T1194-Spearphishing via Service-钓鱼攻击（社工）

## 模块简介

本鱼叉钓鱼是鱼叉钓鱼的特定变体。它与其他形式的鱼叉式广告不同之处在于，它使用了第三方的APP、程序等，而不是直接通过企业电子邮件渠道。

所有形式的鱼叉式攻击都是以电子方式提供的针对特定个人，公司或行业的社会工程。在这种情况下，对手通过各种社交媒体服务，以个人Web邮件和其他非企业控制的应用程序发送消息。与企业控制的应用程序相比，这些服务的安全策略限制可能更低。与大多数种类的鱼叉式攻击一样，目标是与受害者产生密切的关系或以某种方式获得受害者的兴趣。对手将创建虚假的社交媒体帐户，并和员工形成交流关系。这样做可以提出合理的理由来询问企业内部运行的服务，策略和软件。然后，对手可以通过这些服务发送恶意链接或附件。

一个常见的示例是通过社交媒体与目标建立融洽的关系，然后将内容发送到受害者在其工作计算机上使用的个人Webmail服务、个人社交软件等程序。这样一来，对手就可以绕过工作帐户的某些电子邮件限制，并且目标用户更有可能打开该文件，因为这正是他们所期望的。如果有效负载未按预期工作，则对手可以继续正常通信，并针对目标进行故障排除。

## 检测思路

于其他钓鱼攻击类似，本攻击主要检测手段为恶意流量检测和用户行为审计。通过检测用户产生的恶意行为进行检测。

## 应急手段

1. 开启现有的防病毒网关
2. 开启现有的邮件网关
3. 安装主机安全的相关产品
4. 开启恶意流量监测系统
5. 结合恶意情报的用户行为审计

## 排查工具

### 进程类

netstat、ps

### 用户历史

histroy、find

## 工具操作说明

### 进程排查

Netstat

```
netstat -anp | grep "port"
```

ps

```
ps -aux | grep "/bin/bash"
```

### 用户历史

history

```
history | grep "wget"
cat /homr/username/.bash_history | grep -E 'wget|curl'
cat /var/log/audit/audit.log |grep 'wget|curl'
```

find

```
查找24小时内被修改的jsp文件：find / -mtime 0 -name *.jsp
```

