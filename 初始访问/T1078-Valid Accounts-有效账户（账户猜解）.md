# T1078-Valid Accounts-有效账户（账户猜解）

## 模块介绍

攻击者可以使用凭据访问技术窃取特定用户或服务帐户的凭据，或者在侦察过程的早期通过社会工程来获取凭据以获得初始访问权限。

对手可能使用的帐户可以分为三类：默认帐户，本地帐户和域帐户。默认帐户是操作系统内置的帐户，例如Windows系统上的Guest或Administrator帐户，或其他类型的系统，软件或设备上的默认工厂/提供者设置帐户。本地帐户是由组织配置的帐户，供用户，远程支持，服务或在单个系统或服务上进行管理。域帐户是由Active Directory域服务管理的帐户，其中跨该域的系统和服务配置访问和权限。域帐户可以涵盖用户，管理员和服务。

泄漏的凭据可能用于绕过放置在网络内系统上各种资源上的访问控制，甚至可能用于对远程系统和外部可用服务（例如VPN，Outlook Web Access和远程桌面）的持久访问。泄露的凭据也可能授予对手增加对特定系统或访问网络受限区域的特权。攻击者可能选择不将恶意软件或工具与这些凭据提供的合法访问结合使用，以使其更难检测到它们的存在。

默认帐户也不仅限于客户端计算机上的来宾和管理员，它们还包括为设备（例如网络设备和计算机应用程序）而预先设置的帐户，无论它们是内部，开放源代码还是COTS。预先设置了用户名和密码组合的设备会对在安装后不进行更改的组织构成严重威胁，因为它们很容易成为攻击者的目标。同样，攻击者也可以利用公开披露的私钥或被盗的私钥通过远程服务合法地连接到远程环境

帐户访问权，凭据和权限在整个系统网络中的重叠是令人关注的，因为攻击者可能能够跨帐户和系统进行轮转以达到较高的访问级别（即域或企业管理员），从而绕过访问控制集在企业内部。

## 检测思路

本模块的攻击思路主要是针对账户，故检测思路主要在账户安全和暴力破解行为。

## 应急操作

1. 限制使用远程服务的ip地址
2. 修改泄漏的账户密码
3. 检测外部泄漏的账户密码

## 检测工具

账户异常登陆查询

last、lastlog、finger、w等

日志情况

查询日志中暴力破解情况

泄漏信息收集

[FeeiCN / GSIL](https://github.com/FeeiCN/GSIL)

[az0ne / Github_Nuggests](https://github.com/az0ne/Github_Nuggests)

## 工具操作说明

##### 账号历史登录情况

基本介绍

```
who     查看当前登录用户（tty本地登陆  pts远程登录）
w       查看系统信息，想知道某一时刻用户的行为
uptime  查看登陆多久、多少用户，负载
last    查看近期登录系统的用户情况
	/var/log/btmp:文件中保存的是当前正在本系统中的用户的信息。
	/var/log/wtmp:文件中保存的是登录过本系统的用户的信息
lastlog 查看各账号最后登录系统的时间
	/var/log/lastlog：lastlog数据来源
```

##### 日志情况

cat

```
ssh登录日志
cat /var/log/secure | grep "Accepted"
http访问日志
cat /var/log/httpd/apache.log | awk -F '' '{print $1":"$11}'|grep 'ip'
其他产品日志分析
cat /var/log/redis/redis/log | grep 'message'
```

### 